# DO NOT EDIT. FILE GENERATED BY gen pipeline testsuite.
---
env:
  TESTCONTAINERS_RYUK_DISABLED: "true"
notify:
- github_commit_status:
    context: Operator Test Suite
- github_commit_status:
    context: k8s-operator-v2
- github_commit_status:
    context: k8s-operator-v2-helm
steps:
- agents:
    queue: k8s-m6id12xlarge
  command: ./ci/scripts/run-in-nix-docker.sh task ci:configure ci:lint
  key: lint
  label: Lint
  notify:
  - github_commit_status:
      context: Lint
  plugins:
  - github.com/seek-oss/aws-sm-buildkite-plugin#v2.3.2:
      json-to-env:
      - secret-id: sdlc/prod/buildkite/github_api_token
  timeout_in_minutes: 10
- group: Unit Tests
  key: unit
  steps:
  - agents:
      queue: k8s-m6id12xlarge
    command: ./ci/scripts/run-in-nix-docker.sh task ci:configure ci:test:unit
    env:
      LOG_LEVEL: trace
      OTLP_DIR: /work/artifacts
      OTLP_METRIC_INTERVAL: 5s
    key: unit-run
    label: Run Unit Tests
    notify:
    - github_commit_status:
        context: Unit Tests
    plugins:
    - github.com/seek-oss/aws-sm-buildkite-plugin#v2.3.2:
        json-to-env:
        - secret-id: sdlc/prod/buildkite/github_api_token
        - secret-id: sdlc/prod/buildkite/redpanda_sample_license
        - secret-id: sdlc/prod/buildkite/redpanda_second_sample_license
        - secret-id: sdlc/prod/buildkite/slack_vbot_token
    - https://$GITHUB_API_TOKEN@github.com/redpanda-data/step-slack-notify-buildkite-plugin.git#main:
        channel_name: kubernetes-tests
        conditions:
          branches:
          - main
          failed: true
        message: ':cloud: Unit Tests Job Failed'
        slack_token_env_var_name: SLACK_VBOT_TOKEN
    soft_fail: false
    timeout_in_minutes: 15
  - continue_on_failure: true
    wait: null
  - agents:
      queue: pipeline-uploader
    allow_dependency_failure: true
    command: ""
    key: unit-parse
    label: Parse and annotate Unit Tests results
    plugins:
    - github.com/buildkite-plugins/junit-annotate-buildkite-plugin#v2.4.1:
        artifacts: work/artifacts/unit-tests.xml
        context: unit
        report-slowest: 10
    soft_fail: true
- group: Integration Tests
  key: integration
  steps:
  - agents:
      queue: k8s-m6id12xlarge
    command: ./ci/scripts/run-in-nix-docker.sh task ci:configure ci:test:integration
    env:
      LOG_LEVEL: trace
      OTLP_DIR: /work/artifacts
      OTLP_METRIC_INTERVAL: 5s
    key: integration-run
    label: Run Integration Tests
    notify:
    - github_commit_status:
        context: Integration Tests
    plugins:
    - github.com/seek-oss/aws-sm-buildkite-plugin#v2.3.2:
        json-to-env:
        - secret-id: sdlc/prod/buildkite/github_api_token
        - secret-id: sdlc/prod/buildkite/redpanda_sample_license
        - secret-id: sdlc/prod/buildkite/redpanda_second_sample_license
        - secret-id: sdlc/prod/buildkite/slack_vbot_token
    - https://$GITHUB_API_TOKEN@github.com/redpanda-data/step-slack-notify-buildkite-plugin.git#main:
        channel_name: kubernetes-tests
        conditions:
          branches:
          - main
          failed: true
        message: ':cloud: Integration Tests Job Failed'
        slack_token_env_var_name: SLACK_VBOT_TOKEN
    retry:
      automatic:
        limit: 3
    soft_fail: false
    timeout_in_minutes: 90
  - continue_on_failure: true
    wait: null
  - agents:
      queue: pipeline-uploader
    allow_dependency_failure: true
    command: ""
    key: integration-parse
    label: Parse and annotate Integration Tests results
    plugins:
    - github.com/buildkite-plugins/junit-annotate-buildkite-plugin#v2.4.1:
        artifacts: work/artifacts/integration-tests.xml
        context: integration
        report-slowest: 10
    soft_fail: true
- group: Acceptance Tests
  key: acceptance
  steps:
  - agents:
      queue: k8s-m6id12xlarge
    command: ./ci/scripts/run-in-nix-docker.sh task ci:configure ci:test:acceptance
    env:
      LOG_LEVEL: trace
      OTLP_DIR: /work/artifacts
      OTLP_METRIC_INTERVAL: 5s
    key: acceptance-run
    label: Run Acceptance Tests
    notify:
    - github_commit_status:
        context: Acceptance Tests
    plugins:
    - github.com/seek-oss/aws-sm-buildkite-plugin#v2.3.2:
        json-to-env:
        - secret-id: sdlc/prod/buildkite/github_api_token
        - secret-id: sdlc/prod/buildkite/redpanda_sample_license
        - secret-id: sdlc/prod/buildkite/redpanda_second_sample_license
        - secret-id: sdlc/prod/buildkite/slack_vbot_token
    - https://$GITHUB_API_TOKEN@github.com/redpanda-data/step-slack-notify-buildkite-plugin.git#main:
        channel_name: kubernetes-tests
        conditions:
          branches:
          - main
          failed: true
        message: ':cloud: Acceptance Tests Job Failed'
        slack_token_env_var_name: SLACK_VBOT_TOKEN
    retry:
      automatic:
        limit: 3
    soft_fail: false
    timeout_in_minutes: 60
  - continue_on_failure: true
    wait: null
  - agents:
      queue: pipeline-uploader
    allow_dependency_failure: true
    command: ""
    key: acceptance-parse
    label: Parse and annotate Acceptance Tests results
    plugins:
    - github.com/buildkite-plugins/junit-annotate-buildkite-plugin#v2.4.1:
        artifacts: work/artifacts/acceptance-tests.xml
        context: acceptance
        report-slowest: 10
    soft_fail: true
- group: Kuttl-V1 Tests
  key: kuttl-v1
  steps:
  - agents:
      queue: k8s-m6id12xlarge
    command: ./ci/scripts/run-in-nix-docker.sh task ci:configure ci:test:kuttl-v1
    env:
      LOG_LEVEL: trace
      OTLP_DIR: /work/artifacts
      OTLP_METRIC_INTERVAL: 5s
    if: build.pull_request.labels includes "run-kuttl-v1"
    key: kuttl-v1-run
    label: Run Kuttl-V1 Tests
    notify:
    - github_commit_status:
        context: Kuttl-V1 Tests
    plugins:
    - github.com/seek-oss/aws-sm-buildkite-plugin#v2.3.2:
        json-to-env:
        - secret-id: sdlc/prod/buildkite/github_api_token
        - secret-id: sdlc/prod/buildkite/redpanda_sample_license
        - secret-id: sdlc/prod/buildkite/redpanda_second_sample_license
        - secret-id: sdlc/prod/buildkite/slack_vbot_token
    - https://$GITHUB_API_TOKEN@github.com/redpanda-data/step-slack-notify-buildkite-plugin.git#main:
        channel_name: kubernetes-tests
        conditions:
          branches:
          - main
          failed: true
        message: ':cloud: Kuttl-V1 Tests Job Failed'
        slack_token_env_var_name: SLACK_VBOT_TOKEN
    retry:
      automatic:
        limit: 3
    soft_fail: false
    timeout_in_minutes: 90
  - continue_on_failure: true
    wait: null
  - agents:
      queue: pipeline-uploader
    allow_dependency_failure: true
    command: ""
    key: kuttl-v1-parse
    label: Parse and annotate Kuttl-V1 Tests results
    plugins:
    - github.com/buildkite-plugins/junit-annotate-buildkite-plugin#v2.4.1:
        artifacts: work/operator/tests/_e2e_artifacts/kuttl-report.xml
        context: kuttl-v1
        report-slowest: 10
    soft_fail: true
- group: Kuttl-V1-Nodepools Tests
  key: kuttl-v1-nodepools
  steps:
  - agents:
      queue: k8s-m6id12xlarge
    command: ./ci/scripts/run-in-nix-docker.sh task ci:configure ci:test:kuttl-v1-nodepools
    env:
      LOG_LEVEL: trace
      OTLP_DIR: /work/artifacts
      OTLP_METRIC_INTERVAL: 5s
    key: kuttl-v1-nodepools-run
    label: Run Kuttl-V1-Nodepools Tests
    notify:
    - github_commit_status:
        context: Kuttl-V1-Nodepools Tests
    plugins:
    - github.com/seek-oss/aws-sm-buildkite-plugin#v2.3.2:
        json-to-env:
        - secret-id: sdlc/prod/buildkite/github_api_token
        - secret-id: sdlc/prod/buildkite/redpanda_sample_license
        - secret-id: sdlc/prod/buildkite/redpanda_second_sample_license
        - secret-id: sdlc/prod/buildkite/slack_vbot_token
    - https://$GITHUB_API_TOKEN@github.com/redpanda-data/step-slack-notify-buildkite-plugin.git#main:
        channel_name: kubernetes-tests
        conditions:
          branches:
          - main
          failed: true
        message: ':cloud: Kuttl-V1-Nodepools Tests Job Failed'
        slack_token_env_var_name: SLACK_VBOT_TOKEN
    soft_fail: false
    timeout_in_minutes: 30
  - continue_on_failure: true
    wait: null
  - agents:
      queue: pipeline-uploader
    allow_dependency_failure: true
    command: ""
    key: kuttl-v1-nodepools-parse
    label: Parse and annotate Kuttl-V1-Nodepools Tests results
    plugins:
    - github.com/buildkite-plugins/junit-annotate-buildkite-plugin#v2.4.1:
        artifacts: work/operator/tests/_e2e_with_flags_artifacts/kuttl-report.xml
        context: kuttl-v1-nodepools
        report-slowest: 10
    soft_fail: true

