---
---
---
apiVersion: v1
data:
  .bootstrap.json.in: '{}'
  .bootstrap.yaml: ""
  bootstrap.yaml.fixups: '[]'
  redpanda.yaml: |-
    redpanda:
        data_directory: /var/lib/redpanda/data
        seed_servers: []
        rpc_server:
            address: 0.0.0.0
            port: 33145
        kafka_api:
            - address: 0.0.0.0
              port: 9092
            - address: 0.0.0.0
              port: 30093
        admin:
            - address: 0.0.0.0
              port: 9644
    rpk:
        tune_network: true
        tune_disk_scheduler: true
        tune_disk_nomerges: true
        tune_disk_write_cache: true
        tune_disk_irq: true
        tune_cpu: true
        tune_aio_events: true
        tune_clocksource: true
        tune_swappiness: true
        coredump_dir: /var/lib/redpanda/coredump
        tune_ballast_file: true
    pandaproxy: {}
    schema_registry: {}
  redpanda.yaml.fixups: '[]'
  rpk.yaml: |-
    version: 4
    globals:
        prompt: ""
        no_default_cluster: false
        command_timeout: 0s
        dial_timeout: 0s
        request_timeout_overhead: 0s
        retry_timeout: 0s
        fetch_max_wait: 0s
        kafka_protocol_request_client_id: ""
    current_profile: rpk-default-profile
    current_cloud_auth_org_id: default-org-no-id
    current_cloud_auth_kind: ""
    profiles:
        - name: rpk-default-profile
          description: Default RPK profile generated by Redpanda operator
          prompt: ""
          from_cloud: false
          kafka_api:
            brokers:
                - cluster-0.cluster.default.svc.cluster.local.
          admin_api:
            addresses:
                - cluster-0.cluster.default.svc.cluster.local.
          schema_registry:
            addresses:
                - cluster-0.cluster.default.svc.cluster.local.
    cloud_auth:
        - name: default
          organization: Default organization
          org_id: default-org-no-id
          kind: ""
  rpk.yaml.fixups: '[]'
kind: ConfigMap
metadata:
  annotations:
    redpanda.vectorized.io/last-applied-critical-configuration: b2ed85d17a0830e5fa24b159e219ee8f
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
  name: cluster-base
  namespace: default
---
---
---
apiVersion: v1
data:
  password: Y2x1c3Rlcg==
kind: Secret
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
  name: cluster-keystore
  namespace: default
type: Opaque
---
---
---
apiVersion: v1
data:
  postStart.sh: IyEvdXNyL2Jpbi9lbnYgYmFzaApzZXQgLXgKCnBvc3RTdGFydEhvb2sgKCkgewoJdW50aWwgTk9ERV9JRD0kKGN1cmwgLS1zaWxlbnQgLS1mYWlsIGh0dHA6Ly8ke1BPRF9OQU1FfS5jbHVzdGVyLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWw6OTY0NC92MS9ub2RlX2NvbmZpZyB8IGdyZXAgLW8gJ1wibm9kZV9pZFwiOlteLH1dKicgfCBncmVwIC1vICdbXjogXSokJyk7IGRvCgkJc2xlZXAgMC41Cglkb25lCgllY2hvICJDbGVhcmluZyBtYWludGVuYW5jZSBtb2RlIG9uIG5vZGUgJHtOT0RFX0lEfSIKCXVudGlsIFsgIiR7c3RhdHVzOi19IiA9ICIyMDAiIF0gfHwgWyAiJHtzdGF0dXM6LX0iID0gIjQwMCIgXTsgZG8KCQlzdGF0dXM9JChjdXJsIC1YIERFTEVURSAtLXNpbGVudCAtbyAvZGV2L251bGwgLXcgIiV7aHR0cF9jb2RlfSIgaHR0cDovLyR7UE9EX05BTUV9LmNsdXN0ZXIuZGVmYXVsdC5zdmMuY2x1c3Rlci5sb2NhbDo5NjQ0L3YxL2Jyb2tlcnMvJHtOT0RFX0lEfS9tYWludGVuYW5jZSkKCQlzbGVlcCAwLjUKCWRvbmUKfQoKZXhwb3J0IC1mIHBvc3RTdGFydEhvb2sKdGltZW91dCA2MCBiYXNoIC1jICJwb3N0U3RhcnRIb29rIgp0cnVlCg==
  preStop.sh: IyEvdXNyL2Jpbi9lbnYgYmFzaApzZXQgLXgKCnByZVN0b3BIb29rICgpIHsKCXVudGlsIE5PREVfSUQ9JChjdXJsIC0tc2lsZW50IC0tZmFpbCBodHRwOi8vJHtQT0RfTkFNRX0uY2x1c3Rlci5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsOjk2NDQvdjEvbm9kZV9jb25maWcgfCBncmVwIC1vICdcIm5vZGVfaWRcIjpbXix9XSonIHwgZ3JlcCAtbyAnW146IF0qJCcpOyBkbwoJCXNsZWVwIDAuNQoJZG9uZQoJZWNobyAiU2V0dGluZyBtYWludGVuYW5jZSBtb2RlIG9uIG5vZGUgJHtOT0RFX0lEfSIKCXVudGlsIFsgIiR7c3RhdHVzOi19IiA9ICIyMDAiIF07IGRvCgkJc3RhdHVzPSQoY3VybCAtWCBQVVQgLS1zaWxlbnQgLW8gL2Rldi9udWxsIC13ICIle2h0dHBfY29kZX0iIGh0dHA6Ly8ke1BPRF9OQU1FfS5jbHVzdGVyLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWw6OTY0NC92MS9icm9rZXJzLyR7Tk9ERV9JRH0vbWFpbnRlbmFuY2UpCgkJaWYgWyAiJHtzdGF0dXM6LX0iID0gIjQwNCIgXTsgdGhlbgoJCQllY2hvICJHb3QgNDA0IHdoZW4gZW5hYmxpbmcgbWFpbnRlbmFuY2UgbW9kZSwgZ2l2aW5nIHVwIGJlY2F1c2Ugbm9kZSBkb2VzIG5vdCBleGlzdCBhbnltb3JlLiIKCQkJcmV0dXJuIDAKCQlmaQoJCWVjaG8gIkdvdCAke3N0YXR1c30gZm9yIGVuYWJsaW5nIG1haW50LiBtb2RlIgoJCXNsZWVwIDAuNQoJZG9uZQoJdW50aWwgWyAiJHtmaW5pc2hlZDotfSIgPSAidHJ1ZSIgXSB8fCBbICIke2RyYWluaW5nOi19IiA9ICJmYWxzZSIgXTsgZG8KCQlyZXM9JChjdXJsIC0tc2lsZW50IGh0dHA6Ly8ke1BPRF9OQU1FfS5jbHVzdGVyLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWw6OTY0NC92MS9tYWludGVuYW5jZSkKCQlmaW5pc2hlZD0kKGVjaG8gJHJlcyB8IGdyZXAgLW8gJ1wiZmluaXNoZWRcIjpbXix9XSonIHwgZ3JlcCAtbyAnW146IF0qJCcpCgkJZHJhaW5pbmc9JChlY2hvICRyZXMgfCBncmVwIC1vICdcImRyYWluaW5nXCI6W14sfV0qJyB8IGdyZXAgLW8gJ1teOiBdKiQnKQoJCXNsZWVwIDAuNQoJZG9uZQp9CgpleHBvcnQgLWYgcHJlU3RvcEhvb2sKdGltZW91dCA2MCBiYXNoIC1jICJwcmVTdG9wSG9vayIKdHJ1ZQo=
kind: Secret
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: cluster-lifecycle
  namespace: default
type: Opaque
---
---
---
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: cluster
  namespace: default
spec:
  clusterIP: None
  clusterIPs:
  - None
  internalTrafficPolicy: Cluster
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - name: admin
    port: 9644
    protocol: TCP
    targetPort: 9644
  - name: kafka
    port: 9092
    protocol: TCP
    targetPort: 9092
  publishNotReadyAddresses: true
  selector:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/name: redpanda
  sessionAffinity: None
  type: ClusterIP
status:
  loadBalancer: {}
---
---
---
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: cluster-cluster
  namespace: default
spec:
  clusterIP: 10.0.0.1
  clusterIPs:
  - 10.0.0.1
  internalTrafficPolicy: Cluster
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - name: kafka
    port: 9092
    protocol: TCP
    targetPort: 9092
  - name: admin
    port: 9644
    protocol: TCP
    targetPort: 9644
  publishNotReadyAddresses: true
  selector:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/name: redpanda
  sessionAffinity: None
  type: ClusterIP
status:
  loadBalancer: {}
---
---
---
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
  name: cluster-external
  namespace: default
spec:
  clusterIP: 10.0.0.1
  clusterIPs:
  - 10.0.0.1
  externalTrafficPolicy: Local
  internalTrafficPolicy: Cluster
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - name: kafka-external
    nodePort: 30000
    port: 30093
    protocol: TCP
    targetPort: 30093
  sessionAffinity: None
  type: NodePort
status:
  loadBalancer: {}
---
---
---
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: cluster-lb-bootstrap
  namespace: default
spec:
  allocateLoadBalancerNodePorts: true
  clusterIP: 10.0.0.1
  clusterIPs:
  - 10.0.0.1
  externalTrafficPolicy: Cluster
  internalTrafficPolicy: Cluster
  ipFamilies:
  - IPv4
  ipFamilyPolicy: SingleStack
  ports:
  - name: kafka-external-bootstrap
    nodePort: 30000
    port: 9094
    protocol: TCP
    targetPort: 30093
  publishNotReadyAddresses: true
  selector:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/name: redpanda
  sessionAffinity: None
  type: LoadBalancer
status:
  loadBalancer: {}
---
---
---
apiVersion: v1
kind: ServiceAccount
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: cluster
  namespace: default
---
---
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  annotations:
    cluster.redpanda.com/node-pool-spec: '{"name":"default","replicas":1,"storage":{"capacity":"0"},"resources":{"limits":{"cpu":"1","memory":"2Gi"},"requests":{"cpu":"1","memory":"2Gi"}},"cloudCacheStorage":{"capacity":"0"},"hostIndexOffset":0}'
  creationTimestamp: null
  generation: 1
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    cluster.redpanda.com/nodepool: default
  name: cluster
  namespace: default
spec:
  persistentVolumeClaimRetentionPolicy:
    whenDeleted: Retain
    whenScaled: Retain
  podManagementPolicy: Parallel
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/component: redpanda
      app.kubernetes.io/instance: cluster
      app.kubernetes.io/name: redpanda
      cluster.redpanda.com/nodepool: default
  serviceName: cluster
  template:
    metadata:
      annotations:
        redpanda.vectorized.io/configmap-hash: 39c142ed4f14eb54e67428b0365f66d2
      creationTimestamp: null
      labels:
        app.kubernetes.io/component: redpanda
        app.kubernetes.io/instance: cluster
        app.kubernetes.io/managed-by: redpanda-operator
        app.kubernetes.io/name: redpanda
        app.kubernetes.io/part-of: redpanda
        cluster.redpanda.com/nodepool: default
      name: cluster
      namespace: default
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app.kubernetes.io/component: redpanda
                  app.kubernetes.io/instance: cluster
                  app.kubernetes.io/name: redpanda
              namespaces:
              - default
              topologyKey: kubernetes.io/hostname
            weight: 100
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchLabels:
                app.kubernetes.io/component: redpanda
                app.kubernetes.io/instance: cluster
                app.kubernetes.io/name: redpanda
            namespaces:
            - default
            topologyKey: kubernetes.io/hostname
      containers:
      - args:
        - redpanda
        - start
        - --check=false
        - --advertise-rpc-addr=$(POD_NAME).cluster.default.svc.cluster.local.:33145
        - --default-log-level=info
        - --memory=1932735283
        - --reserve-memory=0M
        - --smp=1
        command:
        - /usr/bin/rpk
        env:
        - name: REDPANDA_ENVIRONMENT
          value: kubernetes
        - name: POD_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        - name: POD_IP
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.podIP
        image: ':'
        imagePullPolicy: IfNotPresent
        name: redpanda
        ports:
        - containerPort: 33145
          name: rpc
          protocol: TCP
        - containerPort: 9644
          name: admin
          protocol: TCP
        - containerPort: 9092
          name: kafka
          protocol: TCP
        - containerPort: 30093
          hostPort: 30093
          name: kafka-external
          protocol: TCP
        readinessProbe:
          exec:
            command:
            - bash
            - -xc
            - rpk cluster health --api-urls "http://${POD_NAME}.cluster.default.svc.cluster.local.:9644"|
              grep 'Healthy:.*true'
          failureThreshold: 3
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        resources:
          limits:
            cpu: "1"
            memory: 2Gi
          requests:
            cpu: "1"
            memory: 2Gi
        securityContext:
          runAsGroup: 101
          runAsUser: 101
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /etc/redpanda
          name: config-dir
        - mountPath: /scripts
          name: hook-scripts-dir
        - mountPath: /var/lib/redpanda/.config/rpk
          name: rpk-profile
        - mountPath: /var/lib/redpanda/data
          name: datadir
      dnsPolicy: ClusterFirst
      initContainers:
      - args:
        - configure
        command:
        - /redpanda-operator
        env:
        - name: HOST_INDEX_OFFSET
          value: "0"
        - name: SERVICE_FQDN
          value: cluster.default.svc.cluster.local.
        - name: CONFIG_SOURCE_DIR
          value: /mnt/operator
        - name: CONFIG_DESTINATION
          value: /etc/redpanda/redpanda.yaml
        - name: RPK_PROFILE_DESTINATION
          value: /var/lib/redpanda/.config/rpk/rpk.yaml
        - name: REDPANDA_RPC_PORT
          value: "33145"
        - name: NODE_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: spec.nodeName
        - name: EXTERNAL_CONNECTIVITY
          value: "true"
        - name: EXTERNAL_CONNECTIVITY_SUBDOMAIN
        - name: EXTERNAL_CONNECTIVITY_ADDRESS_TYPE
        - name: EXTERNAL_CONNECTIVITY_KAFKA_ENDPOINT_TEMPLATE
        - name: EXTERNAL_CONNECTIVITY_PANDA_PROXY_ENDPOINT_TEMPLATE
        - name: HOST_IP_ADDRESS
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.hostIP
        - name: HOST_PORT
          value: "30093"
        - name: RACK_AWARENESS
          value: "true"
        - name: VALIDATE_MOUNTED_VOLUME
          value: "false"
        - name: PROXY_HOST_PORT
        - name: ADDITIONAL_LISTENERS
          value: '{}'
        - name: BOOTSTRAP_TEMPLATE
          value: /mnt/operator/.bootstrap.json.in
        - name: BOOTSTRAP_DESTINATION
          value: /etc/redpanda/.bootstrap.yaml
        image: ':'
        imagePullPolicy: IfNotPresent
        name: redpanda-configurator
        resources:
          limits:
            cpu: "1"
            memory: 2Gi
          requests:
            cpu: "1"
            memory: 2Gi
        securityContext:
          runAsGroup: 101
          runAsUser: 101
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /etc/redpanda
          name: config-dir
        - mountPath: /var/lib/redpanda/.config/rpk
          name: rpk-profile
        - mountPath: /mnt/operator
          name: configmap-dir
        - mountPath: /var/lib/redpanda/data
          name: datadir
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        fsGroup: 101
      serviceAccount: cluster
      serviceAccountName: cluster
      terminationGracePeriodSeconds: 120
      topologySpreadConstraints:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/component: redpanda
            app.kubernetes.io/instance: cluster
            app.kubernetes.io/name: redpanda
        maxSkew: 1
        topologyKey: topology.kubernetes.io/zone
        whenUnsatisfiable: ScheduleAnyway
      volumes:
      - configMap:
          defaultMode: 420
          name: cluster-base
        name: configmap-dir
      - emptyDir: {}
        name: config-dir
      - emptyDir: {}
        name: rpk-profile
      - name: hook-scripts-dir
        secret:
          defaultMode: 365
          secretName: cluster-lifecycle
      - name: datadir
        persistentVolumeClaim:
          claimName: datadir
  updateStrategy:
    type: OnDelete
  volumeClaimTemplates:
  - metadata:
      creationTimestamp: null
      labels:
        app.kubernetes.io/component: redpanda
        app.kubernetes.io/instance: cluster
        app.kubernetes.io/managed-by: redpanda-operator
        app.kubernetes.io/name: redpanda
        app.kubernetes.io/part-of: redpanda
        cluster.redpanda.com/nodepool: default
      name: datadir
      namespace: default
    spec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 100Gi
      volumeMode: Filesystem
    status:
      phase: Pending
status:
  availableReplicas: 0
  replicas: 0
---
---
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    nginx.ingress.kubernetes.io/ssl-passthrough: "true"
  creationTimestamp: null
  generation: 1
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: cluster
  namespace: default
spec:
  ingressClassName: nginx
  rules:
  - host: proxy.test.example.com
    http:
      paths:
      - backend:
          service:
            name: cluster-cluster
            port:
              name: proxy-external
        path: /
        pathType: Prefix
status:
  loadBalancer: {}
---
---
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: redpanda-init-configurator
rules:
- apiGroups:
  - ""
  resources:
  - nodes
  verbs:
  - get
---
---
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/component: redpanda
    app.kubernetes.io/instance: cluster
    app.kubernetes.io/managed-by: redpanda-operator
    app.kubernetes.io/name: redpanda
    app.kubernetes.io/part-of: redpanda
    migrate: "true"
  name: redpanda-init-configurator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: redpanda-init-configurator
subjects:
- kind: ServiceAccount
  name: cluster
  namespace: default
